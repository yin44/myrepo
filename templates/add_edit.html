{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
<<<<<<< HEAD
    <h2 class="mb-4">{{ action }} Laptop</h2>
    <form method="post" enctype="multipart/form-data" {% if action == 'Delete' %}onsubmit="return confirm('Are you sure you want to delete this laptop?');"{% elif action == 'Update' %}onsubmit="return confirm('Are you sure you want to update this laptop?');"{% endif %}>
        <div class="form-group">
            <label for="brand">Brand</label>
            <input type="text" class="form-control" id="brand" name="brand"
                   value="{{ laptop.brand if laptop else '' }}"
                   {% if readonly %}readonly{% endif %} required>
        </div>
        <div class="form-group">
            <label for="model">Model</label>
            <input type="text" class="form-control" id="model" name="model"
                   value="{{ laptop.model if laptop else '' }}"
                   {% if readonly %}readonly{% endif %} required>
        </div>
        <div class="form-group">
            <label for="specs">Specs</label>
            <textarea class="form-control" id="specs" name="specs"
                      {% if readonly %}readonly{% endif %} required>{{ laptop.specs if laptop else '' }}</textarea>
        </div>
        <div class="form-group">
            <label for="price">Price</label>
            <input type="number" step="0.01" class="form-control" id="price" name="price"
                   value="{{ laptop.price if laptop else '' }}"
                   {% if readonly %}readonly{% endif %} required>
        </div>
        <div class="form-group">
            <label for="discount">Discount (%)</label>
            <input type="number" step="0.01" class="form-control" id="discount" name="discount"
                   value="{{ laptop.discount if laptop else '' }}"
                   {% if readonly %}readonly{% endif %}>
        </div>
        <div class="form-group">
            <label for="promotion">Promotion</label>
            <input type="text" class="form-control" id="promotion" name="promotion"
                   value="{{ laptop.promotion if laptop else '' }}"
                   {% if readonly %}readonly{% endif %}>
        </div>
        <div class="form-group">
            <label for="stock">Stock</label>
            <input type="number" class="form-control" id="stock" name="stock"
                   value="{{ laptop.stock if laptop else '' }}"
                   {% if readonly %}readonly{% endif %} required>
        </div>
        <div class="form-group">
            <label for="description">Description</label>
            <textarea class="form-control" id="description" name="description"
                      {% if readonly %}readonly{% endif %}>{{ laptop.description if laptop else '' }}</textarea>
        </div>
        <div class="form-group">
            <label for="image">Image</label>
            {% if readonly %}
                <input type="text" class="form-control" value="{{ laptop.image if laptop else '' }}" readonly>
            {% else %}
                <input type="file" class="form-control" id="image" name="image">
                {% if laptop and laptop.image %}
                    <small>Current image: {{ laptop.image }}</small>
                {% endif %}
            {% endif %}
        </div>
        <div class="form-group mt-3">
            {% if action == 'Delete' %}
                <button type="submit" class="btn btn-danger">Confirm Delete</button>
                <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancel</a>
            {% else %}
                <button type="submit" class="btn btn-success">{{ action }}</button>
                <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancel</a>
            {% endif %}
        </div>
    </form>
</div>
=======
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="form-container">
                <h2 class="mb-4 text-center">{{ action }} Laptop</h2>
                <form method="post" enctype="multipart/form-data" {% if action == 'Delete' %}onsubmit="return confirm('Are you sure you want to delete this laptop?');"{% elif action == 'Update' %}onsubmit="return confirm('Are you sure you want to update this laptop?');"{% endif %} id="productForm" novalidate>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="brand">Brand *</label>
                            <input type="text" class="form-control" id="brand" name="brand"
                                   value="{{ laptop.brand if laptop else '' }}"
                                   {% if readonly %}readonly{% endif %} required>
                            <div class="invalid-feedback" id="brand-error"></div>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="model">Model *</label>
                            <input type="text" class="form-control" id="model" name="model"
                                   value="{{ laptop.model if laptop else '' }}"
                                   {% if readonly %}readonly{% endif %} required>
                            <div class="invalid-feedback" id="model-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="specs">Specs *</label>
                        <textarea class="form-control" id="specs" name="specs" rows="3"
                                  {% if readonly %}readonly{% endif %} required>{{ laptop.specs if laptop else '' }}</textarea>
                        <div class="invalid-feedback" id="specs-error"></div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="price">Price *</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">$</span>
                                </div>
                                <input type="number" step="0.01" class="form-control" id="price" name="price"
                                       value="{{ laptop.price if laptop else '' }}"
                                       {% if readonly %}readonly{% endif %} required>
                            </div>
                            <div class="invalid-feedback" id="price-error"></div>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="discount">Discount (%)</label>
                            <div class="input-group">
                                <input type="number" step="0.01" class="form-control" id="discount" name="discount"
                                       value="{{ laptop.discount if laptop else '0' }}"
                                       {% if readonly %}readonly{% endif %} min="0" max="100">
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="invalid-feedback" id="discount-error"></div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="stock">Stock *</label>
                            <input type="number" class="form-control" id="stock" name="stock"
                                   value="{{ laptop.stock if laptop else '0' }}"
                                   {% if readonly %}readonly{% endif %} required min="0">
                            <div class="invalid-feedback" id="stock-error"></div>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="promotion">Promotion</label>
                            <input type="text" class="form-control" id="promotion" name="promotion"
                                   value="{{ laptop.promotion if laptop else '' }}"
                                   {% if readonly %}readonly{% endif %}>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea class="form-control" id="description" name="description" rows="4"
                                  {% if readonly %}readonly{% endif %}>{{ laptop.description if laptop else '' }}</textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="image">Image</label>
                        {% if readonly %}
                            <input type="text" class="form-control" value="{{ laptop.image if laptop else '' }}" readonly>
                        {% else %}
                            <div class="custom-file">
                                <input type="file" class="custom-file-input" id="image" name="image" accept="image/*">
                                <label class="custom-file-label" for="image">
                                    {% if laptop and laptop.image %}
                                        {{ laptop.image }}
                                    {% else %}
                                        Choose file...
                                    {% endif %}
                                </label>
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="form-group text-center mt-4">
                        {% if action == 'Delete' %}
                            <button type="submit" class="btn btn-danger btn-lg">Confirm Delete</button>
                            <a href="{{ url_for('index') }}" class="btn btn-secondary btn-lg">Cancel</a>
                        {% else %}
                            <button type="submit" class="btn btn-success btn-lg">{{ action }} Product</button>
                            <a href="{{ url_for('index') }}" class="btn btn-secondary btn-lg">Cancel</a>
                        {% endif %}
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('productForm');
    const brandInput = document.getElementById('brand');
    const modelInput = document.getElementById('model');
    const specsInput = document.getElementById('specs');
    const priceInput = document.getElementById('price');
    const discountInput = document.getElementById('discount');
    const stockInput = document.getElementById('stock');
    
    function showError(inputId, message) {
        const input = document.getElementById(inputId);
        const errorDiv = document.getElementById(inputId + '-error');
        input.classList.add('is-invalid');
        errorDiv.textContent = message;
        errorDiv.classList.add('show');
    }
    
    function clearError(inputId) {
        const input = document.getElementById(inputId);
        const errorDiv = document.getElementById(inputId + '-error');
        input.classList.remove('is-invalid');
        errorDiv.classList.remove('show');
    }
    
    function validateField(input, inputId, validationFn, errorMessage) {
        if (validationFn(input.value)) {
            clearError(inputId);
            return true;
        } else {
            showError(inputId, errorMessage);
            return false;
        }
    }
    
    // Real-time validation
    brandInput.addEventListener('blur', function() {
        validateField(this, 'brand', value => value.trim().length > 0, 'Brand is required');
    });
    
    modelInput.addEventListener('blur', function() {
        validateField(this, 'model', value => value.trim().length > 0, 'Model is required');
    });
    
    specsInput.addEventListener('blur', function() {
        validateField(this, 'specs', value => value.trim().length > 0, 'Specs are required');
    });
    
    priceInput.addEventListener('blur', function() {
        validateField(this, 'price', value => !isNaN(value) && parseFloat(value) > 0, 'Price must be greater than 0');
    });
    
    discountInput.addEventListener('blur', function() {
        validateField(this, 'discount', value => !isNaN(value) && parseFloat(value) >= 0 && parseFloat(value) <= 100, 'Discount must be between 0 and 100');
    });
    
    stockInput.addEventListener('blur', function() {
        validateField(this, 'stock', value => !isNaN(value) && parseInt(value) >= 0, 'Stock cannot be negative');
    });
    
    // Form submission validation
    form.addEventListener('submit', function(e) {
        let isValid = true;
        
        if (!validateField(brandInput, 'brand', value => value.trim().length > 0, 'Brand is required')) {
            isValid = false;
        }
        
        if (!validateField(modelInput, 'model', value => value.trim().length > 0, 'Model is required')) {
            isValid = false;
        }
        
        if (!validateField(specsInput, 'specs', value => value.trim().length > 0, 'Specs are required')) {
            isValid = false;
        }
        
        if (!validateField(priceInput, 'price', value => !isNaN(value) && parseFloat(value) > 0, 'Price must be greater than 0')) {
            isValid = false;
        }
        
        if (!validateField(discountInput, 'discount', value => !isNaN(value) && parseFloat(value) >= 0 && parseFloat(value) <= 100, 'Discount must be between 0 and 100')) {
            isValid = false;
        }
        
        if (!validateField(stockInput, 'stock', value => !isNaN(value) && parseInt(value) >= 0, 'Stock cannot be negative')) {
            isValid = false;
        }
        
        if (!isValid) {
            e.preventDefault();
            // Show error popup
            const errorPopup = document.createElement('div');
            errorPopup.className = 'error-popup';
            errorPopup.textContent = 'Please fix the validation errors before submitting.';
            document.body.appendChild(errorPopup);
            
            setTimeout(function() {
                errorPopup.remove();
            }, 3000);
        }
    });
    
    // File input customization
    const fileInput = document.getElementById('image');
    if (fileInput) {
        fileInput.addEventListener('change', function(e) {
            const fileName = e.target.files[0]?.name || 'Choose file...';
            const label = e.target.nextElementSibling;
            label.textContent = fileName;
        });
    }
});
</script>
>>>>>>> e1ea81e (email sent for ever status , error messages)
{% endblock %}